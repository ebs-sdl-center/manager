import{u as z,b as S}from"./colorUtil-D0nTnjrQ.js";import{d as _,c as B,r as c,o as $,w as I,a as r,b as n,F as w,e as C,f as l,g as A,n as K,u as T,t as u,h as V,i as H}from"./index-DrUxytEG.js";const N={class:"relative",id:"map",style:{width:"100%",height:"calc(100vh - 3rem)",margin:"0",padding:"0"}},P={class:"absolute top-0 left-0 z-10 h-30 w-full overflow-y-auto rounded bg-white/85 p-2 shadow md:h-60 md:w-max"},W=["onClick"],O=_({__name:"KakaoMap",setup(h){const m=z(),i=B(()=>{const e=new Map;for(const o of[...m.centers]){let a=e.get(o.group_id);a||(a={group_id:o.group_id,group_name:o.group_name??null,group_chief:o.group_chief??null,group_color:o.group_color??null,centers:[]},e.set(o.group_id,a)),a.centers.push(o)}return Array.from(e.values()).sort((o,a)=>o.group_id-a.group_id)}),t=c(null),x=()=>{const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f0b2d739025f158d63463df9837d6e0c&autoload=false",e.onload=()=>{window.kakao.maps.load(v)},e.onerror=()=>new Error("Failed to load script"),document.head.appendChild(e)},f=c([]),p=c([]),E=c(),y=c(0),v=()=>{try{const e=document.getElementById("map"),o={center:new window.kakao.maps.LatLng(36.450701,127.770667),level:12};t.value=new window.kakao.maps.Map(e,o);const a=new window.kakao.maps.ZoomControl;t.value.addControl(a,window.kakao.maps.ControlPosition.RIGHT),E.value=new window.kakao.maps.LatLngBounds,window.kakao.maps.event.addListener(t.value,"zoom_changed",function(){const s=t.value.getLevel();y.value=s,s<10?g(!0):g(!1)}),window.kakao.maps.event.addListener(t.value,"click",function(){t.value.getLevel()>=10&&g(!1)})}catch(e){console.error("Error loading Kakao Maps script:",e)}},D=()=>{if(!t.value){console.warn("Map is not initialized yet");return}f.value.forEach(e=>e.setMap(null)),i.value.forEach(e=>{e.centers.forEach(o=>{const s=`data:image/svg+xml,%3Csvg%20width%3D%22800px%22%20height%3D%22800px%22%20viewBox%3D%22-1%200%2036%2036%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cg%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20transform%3D%22translate%28-125.000000%2C%20-643.000000%29%22%3E%3Cg%20transform%3D%22translate%2837.000000%2C%20169.000000%29%22%3E%3Cg%20transform%3D%22translate%2878.000000%2C%20468.000000%29%22%3E%3Cg%20transform%3D%22translate%2810.000000%2C%206.000000%29%22%3E%3Cpath%20d%3D%22M14%2C0%20C21.732%2C0%2028%2C5.641%2028%2C12.6%20C28%2C23.963%2014%2C36%2014%2C36%20C14%2C36%200%2C24.064%200%2C12.6%20C0%2C5.641%206.268%2C0%2014%2C0%20Z%22%20id%3D%22Shape%22%20stroke%3D%22%23111111%22%20fill%3D%22%23${e.group_color?.replace("#","")||"888888"}%22%3E%3C%2Fpath%3E%3Ccircle%20id%3D%22Oval%22%20fill%3D%22%23fefefe%22%20fill-rule%3D%22nonzero%22%20cx%3D%2214%22%20cy%3D%2214%22%20r%3D%227%22%3E%3C%2Fcircle%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E`,d=new window.kakao.maps.Marker({image:new window.kakao.maps.MarkerImage(s,new window.kakao.maps.Size(32,35)),title:o.name,position:new window.kakao.maps.LatLng(o.lat,o.lng)});d.setMap(t.value),f.value.push(d);const L=`<div class ="bg-white border border-gray-800 px-3 py-1.5 rounded-xl">        <div class="center font-bold">${o.name}</div>        <div class="text-sm">소속거점: ${o.group_name}</div>        <div class="text-sm">센터장: ${o.group_chief??"(미지정)"}</div>        <div class="text-sm">개소일: ${o.open_ymd??"(미지정)"}</div>      </div>`,M=d.getPosition(),k=new window.kakao.maps.CustomOverlay({position:M,content:L,yAnchor:1.7});window.kakao.maps.event.addListener(d,"click",function(){p.value.forEach(F=>F.setMap(null)),k.setMap(t.value)}),p.value.push(k)})})},g=(e=!1)=>{e?p.value.forEach(o=>o.setMap(t.value)):p.value.forEach(o=>o.setMap(null))},b=e=>{if(!t.value)return;const o=new window.kakao.maps.LatLng(e.lat,e.lng);t.value.setCenter(o),t.value.setLevel(5)};return $(()=>{!window.kakao||!window.kakao.maps?(console.log("Kakao Maps script not loaded, loading now..."),x()):(console.log("Kakao Maps script already loaded"),v())}),I(()=>m.centers,e=>{console.log("Centers updated:",e),D()},{deep:!0}),(e,o)=>(l(),r("div",N,[n("div",P,[(l(!0),r(w,null,C(i.value,a=>(l(),r("div",{key:a.group_id,class:"mb-1"},[(l(!0),r(w,null,C(a.centers,s=>(l(),r("div",{key:s.id,class:"mb-1"},[n("div",{class:"flex w-full cursor-pointer items-center py-0.5 hover:bg-amber-100",onClick:d=>b(s)},[n("span",{class:"mr-2 ml-1 rounded-full px-1.5 py-0.5",style:K([{backgroundColor:a.group_color??"#888888",color:T(S)(a.group_color??"#888888").color},{"font-size":"x-small"}])},u(s.group_name),5),A(" "+u(s.name)+" "+u(s.group_chief?`(${s.group_chief})`:"(미지정)")+" ",1),n("span",{class:V(["mr-2 ml-1 rounded-full px-1 text-white",{"bg-amber-600":s.is_moe_budget,"bg-blue-400":!s.is_moe_budget}]),style:{"font-size":"x-small"}},u(s.is_moe_budget?"특교":"지자체"),3)],8,W)]))),128))]))),128))])]))}}),Z={class:"map-container"},q=_({__name:"MapView",setup(h){return(m,i)=>(l(),r(w,null,[i[0]||(i[0]=n("div",{class:"flex h-12 items-center px-6"},[n("h3",{class:"mr-4 text-xl font-black text-gray-700"},"EBS 자기주도학습센터 지도"),n("a",{href:"/manager/list",class:"rounded-full border border-sky-600 px-4 py-0.5 text-sky-800"},"센터 리스트 보기")],-1)),n("div",Z,[H(O)])],64))}});export{q as default};
