import{d as I,c as Y,r as m,o as q,a as J,w as Q,b as c,e as u,f as s,g as X,h as G,v as e2,F as S,i as $,j as o2,n as t2,u as a2,t as x,k as n2,l as s2}from"./index-BWMPxFhy.js";import{u as l2,b as i2}from"./colorUtil-DYf86-Os.js";const r2={class:"super-wrapper"},d2={class:"flex h-12 items-center justify-between px-6"},c2={class:"inline-flex items-center"},u2={class:"mr-4 flex items-center"},p2={key:0,class:"mr-2 text-sm"},m2={class:"relative",id:"map",style:{width:"100%",height:"calc(100vh - 3rem)",margin:"0",padding:"0"}},f2={class:"absolute top-0 left-0 z-10 hidden h-30 w-full overflow-y-auto rounded bg-white/85 p-2 shadow md:block md:h-60 md:w-max"},v2=["onClick"],w2=I({__name:"KakaoMap",setup(B){const v=l2(),y=Y(()=>{const o=new Map;for(const e of[...v.centers]){let t=o.get(e.group_id);t||(t={group_id:e.group_id,group_name:e.group_name??null,group_chief:e.group_chief??null,group_color:e.group_color??null,centers:[]},o.set(e.group_id,t)),t.centers.push(e)}return Array.from(o.values()).sort((e,t)=>e.group_id-t.group_id)}),a=m(null),O=()=>{const o=document.createElement("script");o.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f0b2d739025f158d63463df9837d6e0c&autoload=false",o.onload=()=>{window.kakao.maps.load(M)},o.onerror=()=>new Error("Failed to load script"),document.head.appendChild(o)},L=m([]),w=m([]),T=m(),K=m(0),g=m(!1),M=()=>{try{const o=document.getElementById("map"),e={center:new window.kakao.maps.LatLng(36.450701,127.770667),level:13};a.value=new window.kakao.maps.Map(o,e);const t=new window.kakao.maps.ZoomControl;a.value.addControl(t,window.kakao.maps.ControlPosition.RIGHT),T.value=new window.kakao.maps.LatLngBounds,window.kakao.maps.event.addListener(a.value,"zoom_changed",function(){const n=a.value.getLevel();K.value=n,n<10?_(!0):_(!1)}),window.kakao.maps.event.addListener(a.value,"click",function(){a.value.getLevel()>=10&&_(!1)})}catch(o){console.error("Error loading Kakao Maps script:",o)}};function E(o){const e=o.latLng;if(!p)p=!0,b(),k(),C(),r=new window.kakao.maps.Polyline({map:a.value,path:[e],strokeWeight:5,strokeColor:"#db4040",strokeOpacity:1,strokeStyle:"solid"}),l=new window.kakao.maps.Polyline({strokeWeight:5,strokeColor:"#db4040",strokeOpacity:.5,strokeStyle:"solid"}),z(e,0);else{l.setMap(null),l=null;const t=r.getPath();t.push(e),r.setPath(t),C(),k();const n=Math.round(r.getLength())/1e3;z(e,n),p=!1}}function F(o){if(p){const e=o.latLng,t=r.getPath(),n=[t[t.length-1],e];l.setPath(n),l.setMap(a.value);const h=Math.round(r.getLength()+l.getLength()),f='<div class="bg-red-400/50 border px-1 text-sm">거리 <span class="number">'+h/1e3+"</span>km</div>";j(f,e)}}const V=o=>{o?(window.kakao.maps.event.addListener(a.value,"click",E),window.kakao.maps.event.addListener(a.value,"mousemove",F)):(b(),k(),C(),l&&(l.setMap(null),l=null),p=!1,window.kakao.maps.event.removeListener(a.value,"click",E),window.kakao.maps.event.removeListener(a.value,"mousemove",F))},Z=()=>{a.value&&v.centers.length!==0&&(a.value.setLevel(13),a.value.setCenter(new window.kakao.maps.LatLng(36.450701,127.770667)))},W=()=>{if(!a.value){console.warn("Map is not initialized yet");return}L.value.forEach(o=>o.setMap(null)),y.value.forEach(o=>{o.centers.forEach(e=>{const t=o.group_color?.replace("#","")||"888888",n="111111",h="fefefe";let f="";e.uncertain?f="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20width%3D%2240%22%20zoomAndPan%3D%22magnify%22%20viewBox%3D%220%20-2%2030%2033%22%20height%3D%2240%22%20preserveAspectRatio%3D%22xMidYMid%20meet%22%20version%3D%221.0%22%3E%3Cg%20clip-path%3D%22url%28%23fd52dd4bb2%29%22%3E%3Cpath%20fill%3D%22%23ed1c24%22%20d%3D%22M%2027.585938%2012.765625%20C%2027.585938%205.714844%2021.902344%200%2014.890625%200%20C%207.878906%200%202.191406%205.714844%202.191406%2012.765625%20C%202.191406%2018.445312%205.882812%2023.257812%2010.984375%2024.914062%20L%2014.890625%2029.125%20L%2018.792969%2024.914062%20C%2023.894531%2023.257812%2027.585938%2018.445312%2027.585938%2012.765625%20Z%20M%2027.585938%2012.765625%20%22%20fill-opacity%3D%221%22%20fill-rule%3D%22nonzero%22%20stroke%3D%22%23fefefe%22%20stroke-width%3D%221%22%2F%3E%3C%2Fg%3E%3Cpath%20fill%3D%22%23ffffff%22%20d%3D%22M%2014.890625%205.042969%20C%2013.832031%205.042969%2013%205.945312%2013.074219%207.003906%20L%2013.660156%2015.238281%20C%2013.707031%2015.886719%2014.242188%2016.386719%2014.890625%2016.386719%20C%2015.535156%2016.386719%2016.074219%2015.886719%2016.117188%2015.238281%20L%2016.703125%207.003906%20C%2016.777344%205.945312%2015.945312%205.042969%2014.890625%205.042969%20Z%20M%2014.890625%205.042969%20%22%20fill-opacity%3D%221%22%20fill-rule%3D%22nonzero%22%2F%3E%3Cpath%20fill%3D%22%23ffffff%22%20d%3D%22M%2016.359375%2018.863281%20C%2016.359375%2019.058594%2016.320312%2019.246094%2016.246094%2019.429688%20C%2016.171875%2019.609375%2016.066406%2019.769531%2015.929688%2019.90625%20C%2015.789062%2020.046875%2015.632812%2020.152344%2015.453125%2020.226562%20C%2015.273438%2020.304688%2015.085938%2020.339844%2014.890625%2020.339844%20C%2014.695312%2020.339844%2014.507812%2020.304688%2014.328125%2020.226562%20C%2014.148438%2020.152344%2013.988281%2020.046875%2013.851562%2019.90625%20C%2013.710938%2019.769531%2013.605469%2019.609375%2013.53125%2019.429688%20C%2013.457031%2019.246094%2013.417969%2019.058594%2013.417969%2018.863281%20C%2013.417969%2018.667969%2013.457031%2018.476562%2013.53125%2018.296875%20C%2013.605469%2018.117188%2013.710938%2017.957031%2013.851562%2017.816406%20C%2013.988281%2017.679688%2014.148438%2017.574219%2014.328125%2017.496094%20C%2014.507812%2017.421875%2014.695312%2017.386719%2014.890625%2017.386719%20C%2015.085938%2017.386719%2015.273438%2017.421875%2015.453125%2017.496094%20C%2015.632812%2017.574219%2015.789062%2017.679688%2015.929688%2017.816406%20C%2016.066406%2017.957031%2016.171875%2018.117188%2016.246094%2018.296875%20C%2016.320312%2018.476562%2016.359375%2018.667969%2016.359375%2018.863281%20Z%20M%2016.359375%2018.863281%20%22%20fill-opacity%3D%221%22%20fill-rule%3D%22nonzero%22%2F%3E%3C%2Fsvg%3E":f=`data:image/svg+xml,%3Csvg%20width%3D%22320px%22%20height%3D%22400px%22%20viewBox%3D%223%20-1%2030%2038%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%20%20%3Cg%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%20%20%20%20%3Cg%20transform%3D%22translate%28-125.000000%2C%20-643.000000%29%22%3E%20%20%20%20%20%20%3Cg%20transform%3D%22translate%2837.000000%2C%20169.000000%29%22%3E%20%20%20%20%20%20%20%20%3Cg%20transform%3D%22translate%2878.000000%2C%20468.000000%29%22%3E%20%20%20%20%20%20%20%20%20%20%3Cg%20transform%3D%22translate%2814.000000%2C%206.000000%29%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20%20%20%20%20%20%20%20%20%20%20%20%20%20d%3D%22M14%2C0%20C21.732%2C0%2028%2C5.641%2028%2C12.6%20C28%2C23.963%2014%2C36%2014%2C36%20C14%2C36%200%2C24.064%200%2C12.6%20C0%2C5.641%206.268%2C0%2014%2C0%20Z%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20id%3D%22Shape%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20stroke%3D%22%23${n}%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20fill%3D%22%23${t}%22%20%2F%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Ccircle%20%20%20%20%20%20%20%20%20%20%20%20%20%20id%3D%22Oval%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20fill%3D%22%23${h}%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20fill-rule%3D%22nonzero%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20cx%3D%2214%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20cy%3D%2214%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%3D%227%22%20%2F%3E%20%20%20%20%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%3C%2Fg%3E%20%20%3C%2Fg%3E%3C%2Fsvg%3E`;const D=new window.kakao.maps.Marker({image:new window.kakao.maps.MarkerImage(f,new window.kakao.maps.Size(32,35)),title:e.name,position:new window.kakao.maps.LatLng(e.lat,e.lng)});D.setMap(a.value),L.value.push(D);const R=`<div class ="bg-white/85 border border-gray-800 px-3 py-1.5 rounded-xl">        <div class="center font-bold">${e.name}</div>        <div class="text-sm">소속거점: ${e.group_name}</div>        <div class="text-sm">센터장: ${e.group_chief??"(미지정)"}</div>        <div class="text-sm">개소일: ${e.open_ymd??"(미확정)"}</div>      </div>`,U=D.getPosition(),P=new window.kakao.maps.CustomOverlay({position:U,content:R,yAnchor:1.43});window.kakao.maps.event.addListener(D,"click",function(){a.value.getLevel()>=10&&(w.value.forEach(H=>H.setMap(null)),P.setMap(a.value))}),w.value.push(P)})})},_=(o=!1)=>{o?w.value.forEach(e=>e.setMap(a.value)):w.value.forEach(e=>e.setMap(null))},N=o=>{if(!a.value)return;const e=new window.kakao.maps.LatLng(o.lat,o.lng);a.value.setCenter(e),a.value.setLevel(5)};let p=!1,l=null,r=null,i=null,d=[];function b(){r&&(r.setMap(null),r=null)}function j(o,e){i?(i.setPosition(e),i.setContent(o)):i=new window.kakao.maps.CustomOverlay({map:a.value,content:o,position:e,xAnchor:0,yAnchor:0,zIndex:3})}function k(){i&&(i.setMap(null),i=null)}function z(o,e){const t=new window.kakao.maps.CustomOverlay({content:'<span class="dot bg-white"></span>',position:o,zIndex:1});t.setMap(a.value),e>0&&(i=new window.kakao.maps.CustomOverlay({content:'<div class="bg-white border rounded-md px-1 text-sm">거리 <span class="number">'+e+"</span>km</div>",position:o,yAnchor:1,zIndex:2}),i.setMap(a.value)),d.push({circle:t,distance:i})}function C(){for(let o=0;o<d.length;o++)d[o].circle&&d[o].circle.setMap(null),d[o].distance&&d[o].distance.setMap(null);d=[]}const A=o=>{(o.key==="Escape"||o.key==="Esc"||o.key==="Delete")&&(b(),k(),C(),l&&(l.setMap(null),l=null),p=!1)};return q(()=>{!window.kakao||!window.kakao.maps?(console.log("Kakao Maps script not loaded, loading now..."),O()):(console.log("Kakao Maps script already loaded"),M()),document.addEventListener("keyup",A)}),J(()=>{document.removeEventListener("keyup",A)}),Q(()=>v.centers,o=>{W()},{deep:!0}),(o,e)=>(u(),c("div",r2,[s("div",d2,[e[3]||(e[3]=s("section",{class:"inline-flex items-center"},[s("h3",{class:"mr-4 text-xl font-black text-gray-700"},"EBS 자기주도학습센터 지도"),s("a",{href:"/manager/list",class:"rounded-full border border-sky-600 px-4 py-0.5 text-sky-800"},"센터 리스트 보기")],-1)),s("section",c2,[s("div",u2,[G(s("input",{type:"checkbox",id:"gpsCheck","onUpdate:modelValue":e[0]||(e[0]=t=>g.value=t),onChange:e[1]||(e[1]=t=>V(g.value)),class:"mr-1 h-4 w-4 cursor-pointer"},null,544),[[e2,g.value]]),e[2]||(e[2]=s("label",{for:"gpsCheck",class:"cursor-pointer text-sm select-none"},"거리재기",-1))]),g.value?(u(),c("div",p2,"※거리표시 지우기: ESC or DEL 키")):X("",!0),s("div",{class:"ml-auto cursor-pointer rounded-full border border-gray-600 px-4 py-0.5 text-gray-600 hover:bg-gray-100",onClick:Z}," 전체 지도 ")])]),s("div",m2,[s("div",f2,[(u(!0),c(S,null,$(y.value,t=>(u(),c("div",{key:t.group_id,class:"mb-1"},[(u(!0),c(S,null,$(t.centers,n=>(u(),c("div",{key:n.id,class:"mb-1"},[s("div",{class:"flex w-full cursor-pointer items-center py-0.5 hover:bg-amber-100",onClick:h=>N(n)},[s("span",{class:"mr-2 ml-1 rounded-full px-1.5 py-0.5",style:t2([{backgroundColor:t.group_color??"#888888",color:a2(i2)(t.group_color??"#888888").color},{"font-size":"x-small"}])},x(n.group_name),5),o2(" "+x(n.name)+" "+x(n.group_chief?`(${n.group_chief})`:"(미지정)")+" ",1),s("span",{class:n2(["mr-2 ml-1 rounded-full px-1 text-white",{"bg-amber-600":n.is_moe_budget,"bg-blue-400":!n.is_moe_budget}]),style:{"font-size":"x-small"}},x(n.is_moe_budget?"특교":"지자체"),3)],8,v2)]))),128))]))),128))])])]))}}),g2={class:"map-container"},h2=I({__name:"MapView",setup(B){return(v,y)=>(u(),c("div",g2,[s2(w2)]))}});export{h2 as default};
