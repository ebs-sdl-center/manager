import{d as Y,c as n2,r as c,o as r2,a as i2,w as d2,b as r,e as i,f as a,g as c2,h as y,i as u2,v as p2,j as $,T as j,k as A,l as v2,F as N,m as U,n as P,p as f2,u as m2,t as z,q}from"./index-CDU-aP7D.js";import{u as g2,b as R}from"./colorUtil-CUTV6QNJ.js";const w2={class:"super-wrapper overflow-x-hidden"},h2={class:"header"},k2={class:"flex h-12 items-center justify-between px-6"},C2={class:"inline-flex items-center"},b2={class:"mr-4 hidden items-center md:flex"},x2={key:0,class:"mr-2 text-sm"},_2={class:"map-wrapper relative"},y2={key:0,class:"absolute top-12 left-0 z-50 flex h-12 w-6 cursor-pointer items-center justify-center rounded-tr-xl rounded-br-xl border-t border-r border-b border-gray-400 bg-gray-50/90 drop-shadow-2xl"},D2={key:0,class:"absolute top-12 left-[32.5rem] z-50 flex h-12 w-6 cursor-pointer items-center justify-center rounded-tr-xl rounded-br-xl border-t border-r border-b border-gray-400 bg-gray-50/90 drop-shadow-2xl"},M2={key:1,class:"absolute top-2 bottom-2 left-2 z-10 w-[32rem] overflow-y-auto rounded bg-white/85 p-1 shadow"},L2=["onClick"],E2={key:0,class:"absolute top-2 right-2 bottom-2 z-10 w-96 rounded bg-white/85 p-2 shadow"},F2={class:"center-info"},z2=["innerHTML"],$2=Y({__name:"KakaoMap",setup(D){const p=g2(),m=n2(()=>{const t=new Map;for(const e of[...p.centers]){let o=t.get(e.group_id);o||(o={group_id:e.group_id,group_name:e.group_name??null,group_chief:e.group_chief??null,group_color:e.group_color??null,centers:[],stu_mid_sum:0,stu_high_sum:0},t.set(e.group_id,o)),o.centers.push(e)}for(const e of t.values())e.stu_mid_sum=e.centers.reduce((o,l)=>o+(l.detailInfo?.student_count_mid??0),0),e.stu_high_sum=e.centers.reduce((o,l)=>o+(l.detailInfo?.student_count_high??0),0);return Array.from(t.values()).sort((e,o)=>e.group_id-o.group_id)}),s=c(null),g=c(!1),v=c(!1),J=()=>{const t=document.createElement("script");t.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f0b2d739025f158d63463df9837d6e0c&autoload=false",t.onload=()=>{window.kakao.maps.load(B)},t.onerror=()=>new Error("Failed to load script"),document.head.appendChild(t)},Z=c([]),M=c([]),Q=c(),X=c(0),L=c(!1),h=c(-1),B=()=>{try{const t=document.getElementById("map"),e={center:new window.kakao.maps.LatLng(36.450701,127.770667),level:13};s.value=new window.kakao.maps.Map(t,e),Q.value=new window.kakao.maps.LatLngBounds,window.kakao.maps.event.addListener(s.value,"zoom_changed",function(){const o=s.value.getLevel();X.value=o,o<10?I(!0):I(!1)}),window.kakao.maps.event.addListener(s.value,"click",function(){s.value.getLevel()>=10&&I(!1),g.value=!1,h.value=-1})}catch(t){console.error("Error loading Kakao Maps script:",t)}};function T(t){const e=t.latLng;if(!w)w=!0,S(),E(),F(),u=new window.kakao.maps.Polyline({map:s.value,path:[e],strokeWeight:5,strokeColor:"#db4040",strokeOpacity:1,strokeStyle:"solid"}),n=new window.kakao.maps.Polyline({strokeWeight:5,strokeColor:"#db4040",strokeOpacity:.5,strokeStyle:"solid"}),K(e,0);else{n.setMap(null),n=null;const o=u.getPath();o.push(e),u.setPath(o),F(),E();const l=Math.round(u.getLength())/1e3;K(e,l),w=!1}}function O(t){if(w){const e=t.latLng,o=u.getPath(),l=[o[o.length-1],e];n.setPath(l),n.setMap(s.value);const C=Math.round(u.getLength()+n.getLength()),b='<div class="bg-red-400/50 border px-1 text-sm">거리 <span class="number">'+C/1e3+"</span>km</div>";a2(b,e)}}const G=t=>{t?(window.kakao.maps.event.addListener(s.value,"click",T),window.kakao.maps.event.addListener(s.value,"mousemove",O)):(S(),E(),F(),n&&(n.setMap(null),n=null),w=!1,window.kakao.maps.event.removeListener(s.value,"click",T),window.kakao.maps.event.removeListener(s.value,"mousemove",O))},e2=()=>{s.value&&p.centers.length!==0&&(s.value.setLevel(13),s.value.setCenter(new window.kakao.maps.LatLng(36.450701,127.770667)))},t2=()=>{if(!s.value){console.warn("Map is not initialized yet");return}Z.value.forEach(t=>t.setMap(null)),m.value.forEach(t=>{t.centers.forEach(e=>{const o=t.group_color?.replace("#","")||"888888",l="111111";let C="fefefe";e.group_chief||(C="000000");let b="";e.uncertain?b="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20width%3D%2240%22%20zoomAndPan%3D%22magnify%22%20viewBox%3D%220%20-2%2030%2033%22%20height%3D%2240%22%20preserveAspectRatio%3D%22xMidYMid%20meet%22%20version%3D%221.0%22%3E%3Cg%20clip-path%3D%22url%28%23fd52dd4bb2%29%22%3E%3Cpath%20fill%3D%22%23ed1c24%22%20d%3D%22M%2027.585938%2012.765625%20C%2027.585938%205.714844%2021.902344%200%2014.890625%200%20C%207.878906%200%202.191406%205.714844%202.191406%2012.765625%20C%202.191406%2018.445312%205.882812%2023.257812%2010.984375%2024.914062%20L%2014.890625%2029.125%20L%2018.792969%2024.914062%20C%2023.894531%2023.257812%2027.585938%2018.445312%2027.585938%2012.765625%20Z%20M%2027.585938%2012.765625%20%22%20fill-opacity%3D%221%22%20fill-rule%3D%22nonzero%22%20stroke%3D%22%23fefefe%22%20stroke-width%3D%221%22%2F%3E%3C%2Fg%3E%3Cpath%20fill%3D%22%23ffffff%22%20d%3D%22M%2014.890625%205.042969%20C%2013.832031%205.042969%2013%205.945312%2013.074219%207.003906%20L%2013.660156%2015.238281%20C%2013.707031%2015.886719%2014.242188%2016.386719%2014.890625%2016.386719%20C%2015.535156%2016.386719%2016.074219%2015.886719%2016.117188%2015.238281%20L%2016.703125%207.003906%20C%2016.777344%205.945312%2015.945312%205.042969%2014.890625%205.042969%20Z%20M%2014.890625%205.042969%20%22%20fill-opacity%3D%221%22%20fill-rule%3D%22nonzero%22%2F%3E%3Cpath%20fill%3D%22%23ffffff%22%20d%3D%22M%2016.359375%2018.863281%20C%2016.359375%2019.058594%2016.320312%2019.246094%2016.246094%2019.429688%20C%2016.171875%2019.609375%2016.066406%2019.769531%2015.929688%2019.90625%20C%2015.789062%2020.046875%2015.632812%2020.152344%2015.453125%2020.226562%20C%2015.273438%2020.304688%2015.085938%2020.339844%2014.890625%2020.339844%20C%2014.695312%2020.339844%2014.507812%2020.304688%2014.328125%2020.226562%20C%2014.148438%2020.152344%2013.988281%2020.046875%2013.851562%2019.90625%20C%2013.710938%2019.769531%2013.605469%2019.609375%2013.53125%2019.429688%20C%2013.457031%2019.246094%2013.417969%2019.058594%2013.417969%2018.863281%20C%2013.417969%2018.667969%2013.457031%2018.476562%2013.53125%2018.296875%20C%2013.605469%2018.117188%2013.710938%2017.957031%2013.851562%2017.816406%20C%2013.988281%2017.679688%2014.148438%2017.574219%2014.328125%2017.496094%20C%2014.507812%2017.421875%2014.695312%2017.386719%2014.890625%2017.386719%20C%2015.085938%2017.386719%2015.273438%2017.421875%2015.453125%2017.496094%20C%2015.632812%2017.574219%2015.789062%2017.679688%2015.929688%2017.816406%20C%2016.066406%2017.957031%2016.171875%2018.117188%2016.246094%2018.296875%20C%2016.320312%2018.476562%2016.359375%2018.667969%2016.359375%2018.863281%20Z%20M%2016.359375%2018.863281%20%22%20fill-opacity%3D%221%22%20fill-rule%3D%22nonzero%22%2F%3E%3C%2Fsvg%3E":b=`data:image/svg+xml,%3Csvg%20width%3D%22320px%22%20height%3D%22400px%22%20viewBox%3D%223%20-1%2030%2038%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%20%20%3Cg%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%20%20%20%20%3Cg%20transform%3D%22translate%28-125.000000%2C%20-643.000000%29%22%3E%20%20%20%20%20%20%3Cg%20transform%3D%22translate%2837.000000%2C%20169.000000%29%22%3E%20%20%20%20%20%20%20%20%3Cg%20transform%3D%22translate%2878.000000%2C%20468.000000%29%22%3E%20%20%20%20%20%20%20%20%20%20%3Cg%20transform%3D%22translate%2814.000000%2C%206.000000%29%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20%20%20%20%20%20%20%20%20%20%20%20%20%20d%3D%22M14%2C0%20C21.732%2C0%2028%2C5.641%2028%2C12.6%20C28%2C23.963%2014%2C36%2014%2C36%20C14%2C36%200%2C24.064%200%2C12.6%20C0%2C5.641%206.268%2C0%2014%2C0%20Z%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20id%3D%22Shape%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20stroke%3D%22%23${l}%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20fill%3D%22%23${o}%22%20%2F%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Ccircle%20%20%20%20%20%20%20%20%20%20%20%20%20%20id%3D%22Oval%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20fill%3D%22%23${C}%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20fill-rule%3D%22nonzero%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20cx%3D%2214%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20cy%3D%2214%22%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%3D%227%22%20%2F%3E%20%20%20%20%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%3C%2Fg%3E%20%20%3C%2Fg%3E%3C%2Fsvg%3E`;const x=new window.kakao.maps.Marker({image:new window.kakao.maps.MarkerImage(b,new window.kakao.maps.Size(32,35)),title:e.name,position:new window.kakao.maps.LatLng(e.lat,e.lng),altitude:e.id});x.setMap(s.value),Z.value.push(x);let _='<div class ="bg-white/85 px-3 py-1.5 rounded-xl ';e.uncertain?(_+='border-4 border-red-600">',_+='<div class="text-red-700 font-black mb-1 text-base text-center"> *** 개소 협의 중 *** </div>'):_+='border border-gray-800">',_+=`<div class="center font-bold">${e.name}</div>        <div class="text-sm">소속거점: ${e.group_name}</div>        <div class="text-sm">센터장: ${e.group_chief??"(미지정)"}</div>        <div class="text-sm">개소일: ${e.open_ymd??"(미확정)"}</div>      </div>`;const s2=x.getPosition(),W=new window.kakao.maps.CustomOverlay({position:s2,content:_,yAnchor:1.43});window.kakao.maps.event.addListener(x,"click",function(){h.value=x.getAltitude(),s.value.getLevel()>=10&&(M.value.forEach(l2=>l2.setMap(null)),W.setMap(s.value)),H()}),M.value.push(W)})})},k=c(""),H=()=>{g.value=!0;const t=p.centers.find(e=>e.id===h.value);if(t){const e=t.group_color?t.group_color+"44":"#88888844",o=R(t.group_color||"#888888");k.value=`<div class="mb-4 p-3 rounded-lg border" style="background-color: ${e}; color: ${o}; border-color: ${t.group_color||"#888888"};">`,t.uncertain&&(k.value+='<div class="text-red-700 font-black mb-2 text-lg text-center"> *** 개소 협의 중 *** </div>'),k.value+=`<div class="text-xl font-bold mb-2">${t.name}</div>        <div class="mb-1"><span class="font-semibold">소속거점:</span> ${t.group_name}</div>        <div class="mb-1"><span class="font-semibold">센터장:</span> ${t.group_chief||'<span class="text-red-700 italic">(미지정)</span>'}</div>        <div class="mb-1"><span class="font-semibold">개소일:</span> ${t.open_ymd||'<span class="text-red-700 italic">(미확정)</span>'}</div>        <div class="mb-1"><span class="font-semibold">학생 정원</span></div>        <table class="table-auto w-full border border-gray-600"><thead><tr><th>중학</th><th>고교</th></tr></thead>          <tbody><tr class="border border-gray-600">          <td class="text-center">${t.detailInfo?.student_count_mid??"0"}</td>          <td class="text-center">${t.detailInfo?.student_count_high??"0"}</td>          </tr></tbody>        </table>      </div>`}else k.value='<div class="text-sky-600 font-bold">센터를 선택하세요.</div>'},I=(t=!1)=>{t?M.value.forEach(e=>e.setMap(s.value)):(M.value.forEach(e=>e.setMap(null)),g.value=!1,h.value=-1)},o2=t=>{if(!s.value)return;const e=new window.kakao.maps.LatLng(t.lat,t.lng);s.value.setCenter(e),s.value.setLevel(5),h.value=t.id,H()};let w=!1,n=null,u=null,d=null,f=[];function S(){u&&(u.setMap(null),u=null)}function a2(t,e){d?(d.setPosition(e),d.setContent(t)):d=new window.kakao.maps.CustomOverlay({map:s.value,content:t,position:e,xAnchor:0,yAnchor:0,zIndex:3})}function E(){d&&(d.setMap(null),d=null)}function K(t,e){const o=new window.kakao.maps.CustomOverlay({content:'<span class="dot bg-white"></span>',position:t,zIndex:1});o.setMap(s.value),e>0&&(d=new window.kakao.maps.CustomOverlay({content:'<div class="bg-white border rounded-md px-1 text-sm">거리 <span class="number">'+e+"</span>km</div>",position:t,yAnchor:1,zIndex:2}),d.setMap(s.value)),f.push({circle:o,distance:d})}function F(){for(let t=0;t<f.length;t++)f[t].circle&&f[t].circle.setMap(null),f[t].distance&&f[t].distance.setMap(null);f=[]}const V=t=>{(t.key==="Escape"||t.key==="Esc"||t.key==="Delete")&&(S(),E(),F(),n&&(n.setMap(null),n=null),w=!1)};return r2(()=>{!window.kakao||!window.kakao.maps?(console.log("Kakao Maps script not loaded, loading now..."),J()):(console.log("Kakao Maps script already loaded"),B()),document.addEventListener("keyup",V)}),i2(()=>{document.removeEventListener("keyup",V)}),d2(()=>p.centers,t=>{t2()},{deep:!0}),(t,e)=>(i(),r("div",w2,[a("section",h2,[a("div",k2,[e[5]||(e[5]=c2('<section class="inline-flex items-center" data-v-179190fd><h3 class="mr-4 text-xl font-black text-gray-700" data-v-179190fd>EBS 자기주도학습센터 지도</h3><a href="/manager/list" class="hidden rounded-full border border-sky-600 px-4 py-0.5 text-sky-800 md:block" data-v-179190fd>센터 리스트 페이지</a><a href="/manager/list" class="block rounded-full border border-sky-600 px-4 py-0.5 text-sky-800 md:hidden" data-v-179190fd><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5" data-v-179190fd><path fill-rule="evenodd" d="M4 16.5v-13h-.25a.75.75 0 0 1 0-1.5h12.5a.75.75 0 0 1 0 1.5H16v13h.25a.75.75 0 0 1 0 1.5h-3.5a.75.75 0 0 1-.75-.75v-2.5a.75.75 0 0 0-.75-.75h-2.5a.75.75 0 0 0-.75.75v2.5a.75.75 0 0 1-.75.75h-3.5a.75.75 0 0 1 0-1.5H4Zm3-11a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM7.5 9a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1ZM11 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm.5 3.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Z" clip-rule="evenodd" data-v-179190fd></path></svg></a></section>',1)),a("section",C2,[a("div",b2,[L.value?(i(),r("div",x2,"※거리표시 지우기: ESC or DEL 키")):y("",!0),u2(a("input",{type:"checkbox",id:"gpsCheck","onUpdate:modelValue":e[0]||(e[0]=o=>L.value=o),onChange:e[1]||(e[1]=o=>G(L.value)),class:"mr-1 h-4 w-4 cursor-pointer"},null,544),[[p2,L.value]]),e[4]||(e[4]=a("label",{for:"gpsCheck",class:"cursor-pointer text-sm select-none"},"거리재기",-1))]),a("div",{class:"ml-auto cursor-pointer rounded-full border border-gray-600 px-4 py-0.5 text-gray-600 hover:bg-gray-100",onClick:e2}," 전체 지도 ")])])]),a("section",_2,[$(j,{name:"fade"},{default:A(()=>[v.value?y("",!0):(i(),r("div",y2,[e[7]||(e[7]=a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"size-5"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16ZM6.75 9.25a.75.75 0 0 0 0 1.5h4.59l-2.1 1.95a.75.75 0 0 0 1.02 1.1l3.5-3.25a.75.75 0 0 0 0-1.1l-3.5-3.25a.75.75 0 1 0-1.02 1.1l2.1 1.95H6.75Z","clip-rule":"evenodd"})],-1)),a("div",{class:"touch-area absolute h-16 w-14 bg-transparent",onClick:e[2]||(e[2]=o=>v.value=!v.value)},[...e[6]||(e[6]=[a("span",{class:"sr-only"},"센터 리스트 열기",-1)])])]))]),_:1}),$(v2,{name:"slide-left"},{default:A(()=>[v.value?(i(),r("div",D2,[e[9]||(e[9]=a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"size-5"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.25-7.25a.75.75 0 0 0 0-1.5H8.66l2.1-1.95a.75.75 0 1 0-1.02-1.1l-3.5 3.25a.75.75 0 0 0 0 1.1l3.5 3.25a.75.75 0 0 0 1.02-1.1l-2.1-1.95h4.59Z","clip-rule":"evenodd"}),a("defs",null,[a("clipPath",{id:"a"},[a("path",{d:"M0 0h20v20H0z"})])])],-1)),a("div",{class:"touch-area absolute h-16 w-14 bg-transparent",onClick:e[3]||(e[3]=o=>v.value=!v.value)},[...e[8]||(e[8]=[a("span",{class:"sr-only"},"센터 리스트 닫기",-1)])])])):y("",!0),v.value?(i(),r("div",M2,[(i(!0),r(N,null,U(m.value,o=>(i(),r("div",{key:o.group_id,class:"mb-1"},[(i(!0),r(N,null,U(o.centers,l=>(i(),r("div",{key:l.id,class:"mb-1"},[a("div",{class:"flex w-full cursor-pointer items-center justify-between py-0.5 hover:bg-amber-100",onClick:C=>o2(l)},[a("div",null,[a("span",{class:"mr-2 ml-1 rounded-full px-1.5 py-0.5",style:f2([{backgroundColor:o.group_color??"#888888",color:m2(R)(o.group_color??"#888888").color},{"font-size":"x-small"}])},z(l.group_name),5),P(" "+z(l.name),1)]),a("div",null,[a("span",{class:q(["mx-1",{"font-bold text-red-600 italic":!l.group_chief}])},z(l.group_chief?`(${l.group_chief})`:"(미지정)"),3),a("span",{class:q(["mr-2 ml-1 rounded-full px-1 text-white",{"bg-amber-600":l.is_moe_budget,"bg-blue-400":!l.is_moe_budget}]),style:{"font-size":"x-small"}},z(l.is_moe_budget?"특교":"지자체"),3)])],8,L2)]))),128))]))),128))])):y("",!0)]),_:1}),$(j,{name:"slide-right"},{default:A(()=>[g.value?(i(),r("div",E2,[e[10]||(e[10]=a("div",{class:"notice mb-4 rounded-lg border border-dashed p-2"},[a("div",{class:""},[P(" ※"),a("span",{class:"font-black text-red-700"},"빨간색 느낌표"),P(": 개소 협의 중인 센터 ")]),a("div",{class:"mt-3"},"※가운데 검은색: 센터장 미배정 지역")],-1)),a("div",F2,[a("div",{innerHTML:k.value},null,8,z2)])])):y("",!0)]),_:1}),e[11]||(e[11]=a("div",{class:"relative",id:"map",style:{width:"100%",height:"calc(100vh - 3rem)",margin:"0",padding:"0"}},null,-1))])]))}}),I2=(D,p)=>{const m=D.__vccOpts||D;for(const[s,g]of p)m[s]=g;return m},S2=I2($2,[["__scopeId","data-v-179190fd"]]),A2={class:"map-container"},B2=Y({__name:"MapView",setup(D){return(p,m)=>(i(),r("div",A2,[$(S2)]))}});export{B2 as default};
